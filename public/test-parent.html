<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Parent Test</title>
    <style>
      body { font-family: Arial; padding: 12px; }
      iframe { width: 100%; height: 80vh; border: 1px solid #ccc; border-radius: 8px; }
      pre { background: #111; color: #0f0; padding: 10px; border-radius: 8px; height: 140px; overflow: auto; }
      button { padding: 8px 12px; margin-right: 8px; }
    </style>
  </head>
  <body>
    <h3>Parent Test</h3>
    <div>
      <button id="open">Send OPEN_EDITOR</button>
      <button id="clear">Clear Log</button>
    </div>
    <pre id="log"></pre>

    <iframe id="f" src="/editor/embed"></iframe>

    <script>
      const log = (m) => {
        const el = document.getElementById("log");
        el.textContent += m + "\n";
        el.scrollTop = el.scrollHeight;
      };

      const iframe = document.getElementById("f");

      window.addEventListener("message", (e) => {
        log("⬅️ from iframe: " + JSON.stringify(e.data));
      });

      document.getElementById("open").onclick = () => {
        const payload = {
          type: "OPEN_EDITOR",
          imageUrl: "",
          width: 3,
          height: 3,
          quantity: 100,
          productType: "die-cut",
          price: "10.00",
          pricePerUnit: "0.10",
        };
        log("➡️ to iframe: " + JSON.stringify(payload));
        iframe.contentWindow.postMessage(payload, "*");
      };

      document.getElementById("clear").onclick = () => {
        document.getElementById("log").textContent = "";
      };
    </script>
  </body>
</html>
